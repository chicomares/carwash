<!DOCTYPE html>
<html>
<title>Car Wash & Elections: Crunching The Numbers</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script src="http://d3js.org/d3.v3.js" charset="utf-8"></script>
<script type="text/javascript" src="d3.v3.min.js" charset="utf-8"></script>
<script src="multiline.js" charset="utf-8"></script>
<script src="plotly-latest.min.js"></script>
<script src="numeric.min.js"></script>
<script src="script.js"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="multiline.css">
<link rel="stylesheet" href="treemap.css">
<link rel="stylesheet" href="style.css">

<body>

<!-- Navbar (sit on top) -->
<div class="w3-top">
  <div class="w3-bar" id="myNavbar">
    <a class="w3-bar-item w3-button w3-hover-black w3-hide-medium w3-hide-large w3-right" href="javascript:void(0);" onclick="toggleFunction()" title="Toggle Navigation Menu">
      <i class="fa fa-bars"></i>
    </a>
    <a href="#home" class="w3-bar-item w3-button">HOME</a>
    <a href="#overview" class="w3-bar-item w3-button w3-hide-small">OVERVIEW</a>
    <a href="#sect2" class="w3-bar-item w3-button w3-hide-small">FOLLOWING THE MONEY</a>
    <a href="#2014" class="w3-bar-item w3-button w3-hide-small">2014 ELECTIONS</a>
    <a href="#jbs" class="w3-bar-item w3-button w3-hide-small">JBS: A CASE STUDY</a>
    
  </div>

  <!-- Navbar on small screens -->
  <div id="navDemo" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium">
    <a href="#home" class="w3-bar-item w3-button">HOME</a>
    <a href="#overview" class="w3-bar-item w3-button w3-hide-small">OVERVIEW</a>
    <a href="#sect2" class="w3-bar-item w3-button w3-hide-small">FOLLOWING THE MONEY</a>
    <a href="#2014" class="w3-bar-item w3-button w3-hide-small">2014 ELECTIONS</a>
    <a href="#jbs" class="w3-bar-item w3-button w3-hide-small">JBS: A CASE STUDY</a>
    </div>
</div>

<!-- First Parallax Image with Logo Text -->
<div class="bgimg-1 w3-display-container w3-opacity-min" id="home">
  <div class="display-chico" style="white-space:nowrap;">
    <span class="w3-center w3-padding-large w3-black w3-xlarge w3-wide w3-animate-opacity">CAR WASH & ELECTIONS: CRUNCHING THE NUMBERS
	
	                                                                                   <br>                   by Chico Marés</span>
  </div>
</div>

<!-- Container (About Section) -->
<div class="w3-content w3-container w3-padding-64" id="overview">
  <h3 class="w3-center">OVERVIEW</h3>
  <p class="w3-center"><em>In the last four Brazilian general elections, 21% of the campaign donations came from companies investigated by the Car Wash Operation</em></p>
  <p>Companies implicated in a massive corruption investigation were responsible for 21% of all the campaign donations for general elections in Brazil since 2002. In total, a group of 136 companies contributed with 2.5 billion reais (£600 million) out of a total 16.3 billion (£3.9 billion) – values adjusted by the inflation rate of the period. </p>
<p>To make matters worse, a considerable proportion of this money comes from illegal sources. Instead of bribing politicians directly, some of these companies made contributions to their campaigns as a means to launder the money. The CEOs of two of the biggest campaign contributors in the country, Marcelo Odebrecht, from <a href="http://www.odebrecht.com/en/home" target="_blank">Odebrecht</a>, and Joesley Batista, from <a href="http://jbsglobal.co.uk/" target="_blank">JBS</a>, admitted in court that this was a common practice. They’re, respectively, the largest engineering and the largest meatpacking company in Brazil. </p>
<p>These numbers come from the <a href=" http://english.tse.jus.br/" target="_blank">TSE (Brazil’s Supreme Electoral Court)</a> database, and refer only to <a href="http://www.tse.jus.br/eleicoes/estatisticas/repositorio-de-dados-eleitorais" target="_blank"> official contributions</a> to the 2002, 2006, 2010 and 2014 state and national elections candidates. </p>
<p>Of the top 10 campaign contributors of the last four elections, only three (the ones marked in blue) are not currently being investigated by the so-called <a href=" https://www.theguardian.com/world/2017/jun/01/brazil-operation-car-wash-is-this-the-biggest-corruption-scandal-in-history" target="_blank">Car Wash Operation</a>, a corruption investigation that involves some of the highest-ranking politicians and the largest corporations in Brazil. </p>
<div id="maioresdoadoras" style="width: 960px; height: 800px;"></div>
  <script>var trace1 = {
  x: ['JBS', 'Andrade Gutierrez', 'OAS', 'Camargo Corrêa', 'Queiroz Galvão', 'Itaú', 'UTC Engenharia', 'Odebrecht', 'Banco Alvorada','BMG'],
  y: [460,196,178,163,153,97,90,89,88,62],
  marker:{
    color: ['rgba(255, 0, 0, 1)','rgba(255, 0, 0, 1)','rgba(255, 0, 0, 1)','rgba(255, 0, 0, 1)','rgba(255, 0, 0, 1)','rgba(42, 0, 255, 1)','rgba(255, 0, 0, 1)','rgba(255, 0, 0, 1)','rgba(42, 0, 255, 1)','rgba(42, 0, 255, 1)']
  },
  type: 'bar'
};

var data = [trace1];

var layout = {
  title: 'Top 10 campaign contributors'
};

Plotly.newPlot('maioresdoadoras', data, layout);</script>
<h3>The Operation</h3>
      <p>Run by the Federal Police and the Federal Attorney’s Office, the <a href="http://www.bbc.co.uk/news/world-latin-america-39576896" target="_blank">Car Wash Operation</a> – named after a car wash used for money laundering – revealed a massive web of corruption in the country. The operation started in 2014 and, in the beginning, targeted a group of doleiros (black market money dealers). </p>
  <!-- left side -->
  <div class="w3-row">
    <div class="w3-col m6 w3-center w3-padding-large">
      <p><b><i class="fa fa-user w3-margin-right"></i>An end in sight?</b></p><br>
	  <p>Is there any end in sight for the political crisis in Brazil? And what comes after all this? We asked political scientist David Fleischer, from UnB, what are his predictions for the future of politics in Brazil.</p>
      <iframe width="100%" height="160" src="https://clyp.it/52cspja3/widget" frameborder="0"></iframe>
    </div>

    <!-- right side -->
    <div class="w3-col m6 w3-padding-large">
	
<p>Soon enough, though, the investigators discovered that the main doleiro, Alberto Youssef, used his network to launder money for <a href="https://www.ft.com/content/6e8b0e28-f728-11e5-803c-d27c7117d132" target="_blank">Paulo Roberto Costa</a>, director of Petrobras, a state-run oil company – who had corrupt dealings with politicians and Petrobras contractors. </p>
<p>Costa’s imprisonment had a domino effect. Since then, <a href="https://www.wsj.com/articles/brazils-former-house-speaker-eduardo-cunha-arrested-in-corruption-investigation-1476895613" target="_blank">top rank politicians</a> from all the main political parties, including four former presidents, and some of the largest companies in Brazil have been investigated. </p>
<p>Many have been arrested, including Petrobras directors, politicians and <a href="https://www.nytimes.com/2015/06/20/business/international/brazil-arrests-head-ofodebrecht-in-petrobras-scandal.html" target="_blank">company executives</a>. It also affected the impeachment of president Dilma Rousseff – although that was not the cause of it, the political instability generated by the investigation was decisive for her fall. Last year, the investigation reached current president <a href="http://edition.cnn.com/2017/05/18/americas/brazil-temer-bribery-allegations/index.html" target="_blank">Michel Temer</a> (former Rousseff’s vice-president, <a href="#jbs">see more below</a>). </p>
   
    </div></div>
<p>Amongst the discoveries made by the Federal Police, they found out that many of the campaign contributions were actually bribes. It worked like this: a company would demand a favour from a congressman, or other high-ranking politician. Instead of giving him the money directly, they would make a legal, registered donation to his re-election campaign. </p>
<p>It is impossible, though, to estimate how much of this 2.5 billion reais (£600 million) spent in a twelve-year period had illegal sources. So far, all we know is that at least 400 million reais (£96 million) “donated” by JBS, were confirmed to be direct bribes. Other companies, such as Odebrecht, confirmed to adopt this practice, but did not disclose exactly how much of their donations were bribes. </p>
<h3>An expression of the problem</h3>
<p>According to economist Sérgio Lazzarini, author of the book Capitalismo de Laços (Connection Capitalism), the Car Wash Operation is an expression of a problem within the Brazilian political and economic system. “The public sector opens opportunities to the private sector – e. g. credit and public concessions. The private sector, then, wants to connect with the government to be an privileged position”, he says. </p>
<p> “The main mechanism to achieve this connection over the years is supporting political campaigns. Nonetheless, in many cases, what actually happens is pure bribery – they pay politicians to open the doors of the government.” </p>
<p>David Fleischer, a political scientist who lectures at the National University of Brasília (UnB), these large campaign contributors profited from their donations. “The company has an advantage against their competitors. Many of them, for instance, gained contracts with Petrobras, or were able to improve their contracts after making these donations”, he says, referring to the investigations. </p>
	</div>
 
  <br>
  
<!-- Second Parallax Image with Portfolio Text -->
<div class="bgimg-2 w3-display-container w3-opacity-min">
  <div class="w3-display-middle">
    <span class="w3-xxlarge w3-text-white w3-wide">FOLLOWING THE MONEY</span>
  </div>
</div>

<!-- Container (About Section) -->
<div class="w3-content w3-container w3-padding-64" id="sect2">
  <h3 class="w3-center">FOLLOWING THE MONEY</h3>
  <p class="w3-center"><em>Almost all parties received donations from these companies; the proportion increased significantly from 2010 onwards</em></p>
 <p>As much as the operation affected pretty much every single relevant political group in Brazil, the donations were spread over nearly all political parties that participated on these four elections. Out of 37 parties, 33 received money from these companies – only three small extreme left wing parties, PSTU, PCO and PCB, and now defunct PGT were not in their payroll. </p>
<!-- left side -->
  <div class="w3-row">
    <div class="w3-col m6 w3-center w3-padding-large">
      <p><b>Main parties in Brazil: a quick guide</b></p><br>
	 <p><b>PT</b> (Workers Party): A centre-left party that governed Brazil from 2003 to 2016. Lula is its undisputed leader and recognizable face – for better and for worse. After Dilma Rousseff’s impeachment, became the main opposition party. Somewhat similar to the Labour Party. </p>
     <div id="more" style="display:none;">
	<p><b>PSDB</b> (Brazilian Social Democratic Party): Despite its name and origins, it’s currently a center-right party. Governed the country from 1995 to 2002, with Fernando Henrique Cardoso, and was the main opposition party in the PT era. Now, supports Temer. </p>
<p><b>PMDB</b> (Brazilian Democratic Movement Party): President Michel Temer’s party. It can be described as a vast coalition of regional “caciques” (as political leaders are often referred to in Brazil), spanning from the extreme left to the religious right. From 2006 on, supported Lula and Rousseff (until days before the impeachment), Lula and Cardoso. </p>
<p><b>PP</b> (Progressive Party): Despite its name, it’s one of the main right-wing parties in Brazil. Nonetheless, it was part of Lula and Rousseff’s coalition – until days before the impeachment. Currently supports Temer. </p>
<p><b>DEM</b> (Democrats): Also a right-wing party. Was PSDB main ally during their tenure, and radically opposed PT. Now supports Temer. </p>
<p><b>PSD</b> (Social Democratic Party): Founded in 2011, it was described by its leader, Gilberto Kassab, as “not a right-wing, nor a left-wing, nor a centre party”. Essentially, it supports the government – whichever it is. Also ditched Rousseff at the last minute, also supports Temer. </p>
<p><b>PR</b> (Republic Party): Formerly known as the liberal party, was the first conservative party to make an alliance with the PT and Lula, before the 2002 election. Also ditched Rousseff at the last minute, also supports Temer. </p>
<p><b>PDT</b> (“Trabalhista” Democratic Party): Centre-left party identified with “trabalhismo” (which can be roughly define as a mixture of nationalism, populism and social democracy, very popular in Latin America). Supported PT from the beginning to the end of the tenure, now is an opposition party. </p>
<p><b>PC do B</b> (Communist Party from Brazil): Left-wing party, but not exactly communist anymore. Often described as an extension of PT. Currently on opposition. </p>
<p><b>PPS</b> (Popular Socialist Party): Used to be Brazil’s largest communist party. Nonetheless, it took a turn to the right in the 90s and became a moderate centre party. Although initially part of the coalition, stopped supporting Lula and the PT after political scandals in 2005. Now it’s allied with Temer. </p> </b>
	  </div>
<a href="javascript:showMore()" id="link">Read More</a>	  
    </div>

    <!-- right side -->
    <div class="w3-col m6 w3-padding-large">
	
<p>Of course, some received much more money than others. PT, former presidents Luiz Inácio Lula da Silva and Dilma Rousseff’s party, earned 789 million reais during this period. The main opposition party from 2003 to 2016, PSDB was also favoured by these companies: they received 516 million reais. </p>
<p>Besides being the two most important parties in Brazilian politics during that period, the fact that they both released viable presidential candidates in all four elections also contributed to the high amount of donations received in this period – compared to, for example, PMDB, with a similar number of congressmen and viable candidates for state governments, but received “only” 385 million reais. </p>   
    </div></div>
<p>Three other parties received more than 100 million reais: PSB, Democratas (formerly PFL) and PP (formerly PPB). See how much each party received from each investigated company. </p>
<div id="drop" align=center></div>
<script>

var margin = {top: 80, right: 180, bottom: 80, left: 180},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var svg = d3.select("#drop").append("svg")
	.attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
	.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

d3.tsv("barchart.tsv", function(error, data){

	// filter year
	var data = data.filter(function(d){return d.Year == '2012';});
	// Get every column value
	var elements = Object.keys(data[0])
		.filter(function(d){
			return ((d != "Year") & (d != "State"));
		});
	var selection = elements[0];

	var y = d3.scale.linear()
			.domain([0, d3.max(data, function(d){
				return +d[selection];
			})])
			.range([height, 0]);

	var x = d3.scale.ordinal()
			.domain(data.map(function(d){ return d.State;}))
			.rangeBands([0, width]);


	var xAxis = d3.svg.axis()
		.scale(x)
	    .orient("bottom");

	var yAxis = d3.svg.axis()
		.scale(y)
	    .orient("left");

	svg.append("g")
    	.attr("class", "x axis")
    	.attr("transform", "translate(0," + height + ")")
    	.call(xAxis)
    	.selectAll("text")
    	.style("font-size", "8px")
      	.style("text-anchor", "end")
      	.attr("dx", "-.8em")
      	.attr("dy", "-.55em")
      	.attr("transform", "rotate(-90)" );


 	svg.append("g")
    	.attr("class", "y axis")
    	.call(yAxis);

	svg.selectAll("rectangle")
		.data(data)
		.enter()
		.append("rect")
		.attr("class","rectangle")
		.attr("width", width/data.length)
		.attr("height", function(d){
			return height - y(+d[selection]);
		})
		.attr("x", function(d, i){
			return (width / data.length) * i ;
		})
		.attr("y", function(d){
			return y(+d[selection]);
		})
		.append("title")
		.text(function(d){
			return d.State + " : " + d[selection];
		});

	var selector = d3.select("#drop")
    	.append("select")
    	.attr("id","dropdown")
    	.on("change", function(d){
        	selection = document.getElementById("dropdown");

        	y.domain([0, d3.max(data, function(d){
				return +d[selection.value];})]);

        	yAxis.scale(y);

        	d3.selectAll(".rectangle")
           		.transition()
	            .attr("height", function(d){
					return height - y(+d[selection.value]);
				})
				.attr("x", function(d, i){
					return (width / data.length) * i ;
				})
				.attr("y", function(d){
					return y(+d[selection.value]);
				})
           		.ease("linear")
           		.select("title")
           		.text(function(d){
           			return d.State + " : " + d[selection.value];
           		});
      
           	d3.selectAll("g.y.axis")
           		.transition()
           		.call(yAxis);

         });

    selector.selectAll("option")
      .data(elements)
      .enter().append("option")
      .attr("value", function(d){
        return d;
      })
      .text(function(d){
        return d;
      })


});

</script>
<p>From year to year, the cost of the campaign rose significantly. In 2002, all the candidates earned, together, 1.4 billion reais. 12 years later, this figure rose to 4.4 billion – the values were adjusted to the inflation. </p>
<p>What seems more surprising is that, during this twelve year span, the amount of money spent by the Car Wash investigated companies increased more than ten fold – from 99 million reais to 1.2 billion reais. This means that the proportion and the importance these companies had during this period increased even more significantly then the cost themselves. </p>
  <div class="chart-wrapper" id="yearbyyear"><script type="text/javascript">
    d3.csv('yearbyyear.csv', function(error, data) {
    data.forEach(function (d) {
        d.year = +d.year;
        d.total = +d.total;
        d.carwash = +d.carwash;        
    });
    var chart = makeLineChart(data, 'year', {
        'Total donations (in millions of reais)': {column: 'total'},
        'Car Wash donations (in millions of reais)': {column: 'carwash'},
    }, {xAxis: 'Years', yAxis: 'Donations'});
    chart.bind("#yearbyyear");
    chart.render();
});
  </script>
 
</div> <p>According to Emerson Urizzi Cervi, professor at the Political Sciences department of Federal University of Paraná, it was not the cost of the campaigns that increased, but the volume of contribution from large companies. </p>
<p> “Large companies started to use campaign donations to strengthen their ties to the political elite”, says Cervi. According to him, these large contributors tend to focus their donations on presidential elections. “The political campaigns got more expensive, but not in a homogeneous way”.</p></div>
  <br>
<br>
<!-- THIRD IMAGE -->
<div class="bgimg-3 w3-display-container w3-opacity-min">
  <div class="w3-display-middle">
    <span class="w3-xxlarge w3-text-white w3-wide">2014 ELECTIONS</span>
  </div>
</div>

<!-- Container (Portfolio Section) -->
<div class="w3-content w3-container w3-padding-64" id="2014">
  <h3 class="w3-center">2014 ELECTIONS</h3>
  <p>Due to changes in the rules by the TSE, the 2014 election accountability report allows us to see with much more detail the dynamics of campaign spending in Brazil. In previous years, we could see how much each candidate received and how much each donor spent, but since they could funnel their donations through parties, it was impossible to say how much money each company donated to each candidate. </p>
<p>1,627 candidates were elected for five different offices in that year: 1,059 state/district deputies, 513 federal deputies, 27 senators, 27 governors and, of course, the president. 1,051 of them received donations from companies investigated by the Car Wash operation. </p>
<div id="chart"></div>
<script>


window.addEventListener('message', function(e) {
    var opts = e.data.opts,
        data = e.data.data;

    return main(opts, data);
});

var defaults = {
    margin: {top: 24, right: 0, bottom: 0, left: 0},
    rootname: "TOP",
    format: ",d",
    title: "",
    width: 960,
    height: 500
};

function main(o, data) {
  var root,
      opts = $.extend(true, {}, defaults, o),
      formatNumber = d3.format(opts.format),
      rname = opts.rootname,
      margin = opts.margin,
      theight = 36 + 16;

  $('#chart').width(opts.width).height(opts.height);
  var width = opts.width - margin.left - margin.right,
      height = opts.height - margin.top - margin.bottom - theight,
      transitioning;
  
  var color = d3.scale.category20c();
  
  var x = d3.scale.linear()
      .domain([0, width])
      .range([0, width]);
  
  var y = d3.scale.linear()
      .domain([0, height])
      .range([0, height]);
  
  var treemap = d3.layout.treemap()
      .children(function(d, depth) { return depth ? null : d._children; })
      .sort(function(a, b) { return a.value - b.value; })
      .ratio(height / width * 0.5 * (1 + Math.sqrt(5)))
      .round(false);
  
  var svg = d3.select("#chart").append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.bottom + margin.top)
      .style("margin-left", -margin.left + "px")
      .style("margin.right", -margin.right + "px")
    .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
      .style("shape-rendering", "crispEdges");
  
  var grandparent = svg.append("g")
      .attr("class", "grandparent");
  
  grandparent.append("rect")
      .attr("y", -margin.top)
      .attr("width", width)
      .attr("height", margin.top);
  
  grandparent.append("text")
      .attr("x", 6)
      .attr("y", 6 - margin.top)
      .attr("dy", ".75em");

  if (opts.title) {
    $("#chart").prepend("<p class='title'>" + opts.title + "</p>");
  }
  if (data instanceof Array) {
    root = { key: rname, values: data };
  } else {
    root = data;
  }
    
  initialize(root);
  accumulate(root);
  layout(root);
  console.log(root);
  display(root);

  if (window.parent !== window) {
    var myheight = document.documentElement.scrollHeight || document.body.scrollHeight;
    window.parent.postMessage({height: myheight}, '*');
  }

  function initialize(root) {
    root.x = root.y = 0;
    root.dx = width;
    root.dy = height;
    root.depth = 0;
  }

  // Aggregate the values for internal nodes. This is normally done by the
  // treemap layout, but not here because of our custom implementation.
  // We also take a snapshot of the original children (_children) to avoid
  // the children being overwritten when when layout is computed.
  function accumulate(d) {
    return (d._children = d.values)
        ? d.value = d.values.reduce(function(p, v) { return p + accumulate(v); }, 0)
        : d.value;
  }

  // Compute the treemap layout recursively such that each group of siblings
  // uses the same size (1×1) rather than the dimensions of the parent cell.
  // This optimizes the layout for the current zoom state. Note that a wrapper
  // object is created for the parent node for each group of siblings so that
  // the parent’s dimensions are not discarded as we recurse. Since each group
  // of sibling was laid out in 1×1, we must rescale to fit using absolute
  // coordinates. This lets us use a viewport to zoom.
  function layout(d) {
    if (d._children) {
      treemap.nodes({_children: d._children});
      d._children.forEach(function(c) {
        c.x = d.x + c.x * d.dx;
        c.y = d.y + c.y * d.dy;
        c.dx *= d.dx;
        c.dy *= d.dy;
        c.parent = d;
        layout(c);
      });
    }
  }

  function display(d) {
    grandparent
        .datum(d.parent)
        .on("click", transition)
      .select("text")
        .text(name(d));

    var g1 = svg.insert("g", ".grandparent")
        .datum(d)
        .attr("class", "depth");

    var g = g1.selectAll("g")
        .data(d._children)
      .enter().append("g");

    g.filter(function(d) { return d._children; })
        .classed("children", true)
        .on("click", transition);

    var children = g.selectAll(".child")
        .data(function(d) { return d._children || [d]; })
      .enter().append("g");

    children.append("rect")
        .attr("class", "child")
        .call(rect)
      .append("title")
        .text(function(d) { return d.key + " (" + formatNumber(d.value) + ")"; });
    children.append("text")
        .attr("class", "ctext")
        .text(function(d) { return d.key; })
        .call(text2);

    g.append("rect")
        .attr("class", "parent")
        .call(rect);

    var t = g.append("text")
        .attr("class", "ptext")
        .attr("dy", ".75em")

    t.append("tspan")
        .text(function(d) { return d.key; });
    t.append("tspan")
        .attr("dy", "1.0em")
        .text(function(d) { return formatNumber(d.value); });
    t.call(text);

    g.selectAll("rect")
        .style("fill", function(d) { return color(d.key); });

    function transition(d) {
      if (transitioning || !d) return;
      transitioning = true;

      var g2 = display(d),
          t1 = g1.transition().duration(750),
          t2 = g2.transition().duration(750);

      // Update the domain only after entering new elements.
      x.domain([d.x, d.x + d.dx]);
      y.domain([d.y, d.y + d.dy]);

      // Enable anti-aliasing during the transition.
      svg.style("shape-rendering", null);

      // Draw child nodes on top of parent nodes.
      svg.selectAll(".depth").sort(function(a, b) { return a.depth - b.depth; });

      // Fade-in entering text.
      g2.selectAll("text").style("fill-opacity", 0);

      // Transition to the new view.
      t1.selectAll(".ptext").call(text).style("fill-opacity", 0);
      t1.selectAll(".ctext").call(text2).style("fill-opacity", 0);
      t2.selectAll(".ptext").call(text).style("fill-opacity", 1);
      t2.selectAll(".ctext").call(text2).style("fill-opacity", 1);
      t1.selectAll("rect").call(rect);
      t2.selectAll("rect").call(rect);

      // Remove the old node when the transition is finished.
      t1.remove().each("end", function() {
        svg.style("shape-rendering", "crispEdges");
        transitioning = false;
      });
    }

    return g;
  }

  function text(text) {
    text.selectAll("tspan")
        .attr("x", function(d) { return x(d.x) + 6; })
    text.attr("x", function(d) { return x(d.x) + 6; })
        .attr("y", function(d) { return y(d.y) + 6; })
        .style("opacity", function(d) { return this.getComputedTextLength() < x(d.x + d.dx) - x(d.x) ? 1 : 0; });
  }

  function text2(text) {
    text.attr("x", function(d) { return x(d.x + d.dx) - this.getComputedTextLength() - 6; })
        .attr("y", function(d) { return y(d.y + d.dy) - 6; })
        .style("opacity", function(d) { return this.getComputedTextLength() < x(d.x + d.dx) - x(d.x) ? 1 : 0; });
  }

  function rect(rect) {
    rect.attr("x", function(d) { return x(d.x); })
        .attr("y", function(d) { return y(d.y); })
        .attr("width", function(d) { return x(d.x + d.dx) - x(d.x); })
        .attr("height", function(d) { return y(d.y + d.dy) - y(d.y); });
  }

  function name(d) {
    return d.parent
        ? name(d.parent) + " / " + d.key + " (" + formatNumber(d.value) + ")"
        : d.key + " (" + formatNumber(d.value) + ")";
  }
}

if (window.location.hash === "") {
    d3.json("candidatos3.json", function(err, res) {
        if (!err) {
            console.log(res);
            var data = d3.nest().key(function(d) { return d.party; }).key(function(d) { return d.office; }).key(function(d) { return d.candidate; }).entries(res);
            main({title: "All the donations from Car Wash investigated companies"}, {key: "Donations", values: data});
        }
    });
}

</script>
<p>The higher the rank, the larger the proportion. Of all elected governors, only one did not receive donations from investigated companies. In the federal Congress, 20 elected senators (75%) and 394 federal deputies (76%) were in the companies’ payroll. 610 state or district deputies (57%), the lowest rank offices on that election, received donations. </p>
<div id="bolota" style="width: 960px; height: 600px;"></div>
<script>
var data = [{
  values: [26,1],
  labels: ['Received','Did not receive'],
  domain: {
    x: [0, .23],
    y: [.3, .88]
  },
  name: 'Governor',
  hoverinfo: 'label+value+name',
  hole: .4,
  type: 'pie'
},{
  values: [20,7],
  labels: ['Received','Did not receive'],
  domain: {
    x: [.25, .48],
    y: [.3, .88]
  },
  name: 'Senator',
  hoverinfo: 'label+value+name',
  hole: .4,
  type: 'pie'
},{
  values: [394,119],
  labels: ['Received','Did not receive'],
  domain: {
    x: [.50, .73],
    y: [.3, .88]
  },
  name: 'Federal Deputy',
  hoverinfo: 'label+value+name',
  hole: .4,
  type: 'pie'
},
            {
  values: [610,449],
  labels: ['Received','Did not receive'],
  text: 'State Deputy',
  textposition: 'inside',
  domain: {x: [.75, 1],
          y: [.3, .88]},
  name: 'State Deputy',
  hoverinfo: 'label+value+name',
  hole: .4,
  type: 'pie'
}];

var layout = {
  title: 'Elected officials who received donations from investigated companies',
  annotations: [
    {
      font: {
        size: 12
      },
      showarrow: false,
      text: 'Governor',
      x: 0.075,
      y: 0.3
    },
    {
      font: {
        size: 12
      },
      showarrow: false,
      text: 'Senator',
      x: 0.365,
      y: 0.3
    },
    {
      font: {
        size: 12
      },
      showarrow: false,
      text: 'Federal Deputy',
      x: 0.615,
      y: 0.3
    },
    {
      font: {
        size: 12
      },
      showarrow: false,
      text: 'State Deputy',
      x: 0.92,
      y: 0.3
    }
  ],
  height: 600,
  width: 960
};

Plotly.newPlot('bolota', data, layout);

</script>
<p>Not surprisingly, incumbent candidate Rousseff, who had the most expensive campaign during those elections, was the main beneficiary of the donations. She received 219 million reais from these companies, 62% of her campaign total earnings. Her main opponent, senator Aécio Neves, received 99 million (41% of his campaign’s earnings). </p>
<p>In both camps, JBS, the meatpacking giant, was the main contributor – see more on the following section. Andrade Gutierrez and OAS also made meaningful contributions to Rousseff’s re-election bid. Both companies were part of a cartel that controlled contracts with Petrobras and the federal government. In Neves’ case, it was Andrade Gutierrez and Odebrecht – a company that, at the time of the election, was already being investigated for corruption. </p>
<p>As in previous years, almost all political groups received donations from these companies – the exceptions are small, extreme left-wing parties. Nonetheless, the amount of money and the proportion of it vary greatly from group to group. </p>
<p>Rousseff and Lula’s party, PT received 424 million in total – 44% of their earnings. PSDB, the main opposition party, was ranked second in absolute numbers – 212 million reais – and third in proportion – 29%. </p>

 </div> 
 <br> 
 <!-- FOURTH IMAGE -->
<div class="bgimg-4 w3-display-container w3-opacity-min">
  <div class="w3-display-middle">
    <span class="w3-xxlarge w3-text-white w3-wide">JBS: A CASE STUDY</span>
  </div>
</div> 
  <!-- Container (Portfolio Section) -->
<div class="w3-content w3-container w3-padding-64" id="jbs">
  <h3 class="w3-center">JBS: A CASE STUDY</h3>
  <p>Meatpacking giant JBS sits on the top of the list of campaign contributors over the last 12 years, having spent 453 million reais (£108 million) since 2006. The amount of money the company donated is remarkable, to say the least: it’s more than Andrade Gutierrez and Camargo Correia, respectively second and third on the ranking, combined. </p>
<p>If you are following the latest developments in Brazilian politics, the name probably rang a bell. JBS is on the eye of the hurricane of the last chapter of the scandal parade that Brasília has become over the last three years. </p>
<p>A quick recap: Joesley Batista, JBS’s CEO, was being investigated by the Car Wash Operation, and agreed to cooperate with the prosecutors. On March, he recorded a conversation with Brazil president Michel Temer, in which they discussed paying a monthly allowance to Eduardo Cunha, a former politician currently in prison, for his silence. Temer claims the tape has been edited. </p>
<p>Batista also paid 500,000 reais illegally to one of Temer’s key assistants, Rodrigo Rocha Loures, and recorded Aécio Neves, senator and defeated opposition presidential candidate in 2014, asking for bribes. Finally, JBS’s CEO stated that former presidents Luís Inácio Lula da Silva and Dilma Rousseff had personal accounts in Switzerland to receive illegal payments from the company. </p>
<p>Not only did the company invest a large sum in political campaigns, it also spread their donations to reach virtually all parties and all relevant political figures in the country. Since 2006, JBS donated to 28 different political parties, from the left to the right – in fact, of all the official political associations that were involved in those elections, only four small extreme left-wing parties (PSOL, PSTU, PCB and PCO) did not receive any money from the beef conglomerate. </p>
<p>In 2014, these donations reached 1.988 different candidates – including most of the country’s most important political leaders. Of 27 elected state governors, 16 were financed by JBS. In Congress, the company helped 182 current federal deputies (out of 513) and 12 senators (out of 27) get elected – and they also contributed to 21% of the elected state deputies. </p>
<p>Last, but far from least, they contributed to the three main presidential campaigns. Dilma Rousseff received 74 million reais from JBS, which amounts to 21% of her campaigns earnings. Neves received 30 million, 13% of his total budget. Marina Silva, which ran on a third-way platform, received 4.5 million. </p>
<p>They also contributed to Eduardo Campos, who died in a plane crash before the election and was replaced by Silva, and to Levy Fidélix, an extreme nationalist candidate who received less than 500,000 votes.</p>

  
  
  
  
  
  
  
  
  
  <p class="w3-center"><em>Here are some of my latest lorem work ipsum tipsum.<br> Click on the images to make them bigger</em></p><br>

  <!-- Responsive Grid. Four columns on tablets, laptops and desktops. Will stack on mobile devices/small screens (100% width) -->
  <div class="w3-row-padding w3-center">
    <div class="w3-col m3">
      <img src="/w3images/p1.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="The mist over the mountains">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p2.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Coffee beans">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p3.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Bear closeup">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p4.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Quiet ocean">
    </div>
  </div>

  <div class="w3-row-padding w3-center w3-section">
    <div class="w3-col m3">
      <img src="/w3images/p5.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="The mist">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p6.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="My beloved typewriter">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p7.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Empty ghost train">
    </div>

    <div class="w3-col m3">
      <img src="/w3images/p8.jpg" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Sailing">
    </div>
    <button class="w3-button w3-padding-large w3-light-grey" style="margin-top:64px">LOAD MORE</button>
  </div>
</div>

<!-- Modal for full size images on click-->
<div id="modal01" class="w3-modal w3-black" onclick="this.style.display='none'">
  <span class="w3-button w3-large w3-black w3-display-topright" title="Close Modal Image"><i class="fa fa-remove"></i></span>
  <div class="w3-modal-content w3-animate-zoom w3-center w3-transparent w3-padding-64">
    <img id="img01" class="w3-image">
    <p id="caption" class="w3-opacity w3-large"></p>
  </div>
</div>

<!-- Third Parallax Image with Portfolio Text -->
<div class="bgimg-3 w3-display-container w3-opacity-min">
  <div class="w3-display-middle">
     <span class="w3-xxlarge w3-text-white w3-wide">CONTACT</span>
  </div>
</div>

<!-- Container (Contact Section) -->
<div class="w3-content w3-container w3-padding-64" id="contact">
  <h3 class="w3-center">WHERE I WORK</h3>
  <p class="w3-center"><em>I'd love your feedback!</em></p>

  <div class="w3-row w3-padding-32 w3-section">
    <div class="w3-col m4 w3-container">
      <!-- Add Google Maps -->
      <div id="googleMap" class="w3-round-large w3-greyscale" style="width:100%;height:400px;"></div>
    </div>
    <div class="w3-col m8 w3-panel">
      <div class="w3-large w3-margin-bottom">
        <i class="fa fa-map-marker fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Chicago, US<br>
        <i class="fa fa-phone fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Phone: +00 151515<br>
        <i class="fa fa-envelope fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Email: mail@mail.com<br>
      </div>
      <p>Swing by for a cup of <i class="fa fa-coffee"></i>, or leave me a note:</p>
      <form action="/action_page.php" target="_blank">
        <div class="w3-row-padding" style="margin:0 -16px 8px -16px">
          <div class="w3-half">
            <input class="w3-input w3-border" type="text" placeholder="Name" required name="Name">
          </div>
          <div class="w3-half">
            <input class="w3-input w3-border" type="text" placeholder="Email" required name="Email">
          </div>
        </div>
        <input class="w3-input w3-border" type="text" placeholder="Message" required name="Message">
        <button class="w3-button w3-black w3-right w3-section" type="submit">
          <i class="fa fa-paper-plane"></i> SEND MESSAGE
        </button>
      </form>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="w3-center w3-black w3-padding-64 w3-opacity w3-hover-opacity-off">
  <a href="#home" class="w3-button w3-light-grey"><i class="fa fa-arrow-up w3-margin-right"></i>To the top</a>
  <div class="w3-xlarge w3-section">
    <i class="fa fa-facebook-official w3-hover-opacity"></i>
    <i class="fa fa-instagram w3-hover-opacity"></i>
    <i class="fa fa-snapchat w3-hover-opacity"></i>
    <i class="fa fa-pinterest-p w3-hover-opacity"></i>
    <i class="fa fa-twitter w3-hover-opacity"></i>
    <i class="fa fa-linkedin w3-hover-opacity"></i>
  </div>
  <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>
</footer>
 
<!-- Add Google Maps -->
<script>
function myMap()
{
  myCenter=new google.maps.LatLng(41.878114, -87.629798);
  var mapOptions= {
    center:myCenter,
    zoom:12, scrollwheel: false, draggable: false,
    mapTypeId:google.maps.MapTypeId.ROADMAP
  };
  var map=new google.maps.Map(document.getElementById("googleMap"),mapOptions);

  var marker = new google.maps.Marker({
    position: myCenter,
  });
  marker.setMap(map);
}

// Modal Image Gallery
function onClick(element) {
  document.getElementById("img01").src = element.src;
  document.getElementById("modal01").style.display = "block";
  var captionText = document.getElementById("caption");
  captionText.innerHTML = element.alt;
}

// Change style of navbar on scroll
window.onscroll = function() {myFunction()};
function myFunction() {
    var navbar = document.getElementById("myNavbar");
    if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
        navbar.className = "w3-bar" + " w3-card-2" + " w3-animate-top" + " w3-white";
    } else {
        navbar.className = navbar.className.replace(" w3-card-2 w3-animate-top w3-white", "");
    }
}

// Used to toggle the menu on small screens when clicking on the menu button
function toggleFunction() {
    var x = document.getElementById("navDemo");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else {
        x.className = x.className.replace(" w3-show", "");
    }
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBu-916DdpKAjTmJNIgngS6HL_kDIKU0aU&callback=myMap"></script>
<!--
To use this code on your website, get a free API key from Google.
Read more at: https://www.w3schools.com/graphics/google_maps_basic.asp
-->

</body>
</html>
